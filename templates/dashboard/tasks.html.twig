{% extends 'base.html.twig' %}

{% block title %}My Tasks
{% endblock %}
{% block breadcrumb %}
	<li class="breadcrumb-item active">{% trans %}
		My Tasks
		{% endtrans %}</li>
{% endblock %}
{% block pagetitle %}
	{% trans %}
	My Tasks{% endtrans %}
{% endblock %}
{% block body %}
	<div class="container-fluid">
		<div class="row">
			<div class="card card-primary col-sm-4 px-0 mr-5">
				<div class="card-header">
					<h3 class="card-title">
						To Do
					</h3>
				</div>
				<div class="card-body">
					{% for todo in todo_list %}
						<div class="card card-light card-outline collapsed-card drag">
							<div class="card-header">
								<h5 class="card-title"> {{ todo.activity.title }}
								</h5>
								<div class="card-tools">
									<a href="#" class="btn btn-tool btn-link">{{ todo.endDate ? todo.endDate|date('M d') : '' }}</a>
									<button type="button" class="btn  btn-sm" data-card-widget="collapse">
										<i class="fas fa-plus"></i>
									</button>
								</div>
							</div>
							<div class="card-body">
								<p> {{ todo.assignmentDescription|raw }}
								</p>
							</div>
							<div class="card-footer">
								<div class="btn-group d-flex">
									<button class="btn btn-primary">
										Files
									</button>

									<button class="btn btn-warning">
										Progress
									</button>

									<button class="btn btn-danger">
										Members
									</button>
								</div>
							</div>
						</div>
					{% endfor %}
				</div>
			</div><br>
			<div class="card card-default col-sm-4 px-0 mr-5">
				<div class="card-header bg-info">
					<h3 class="card-title">
						Doing
					</h3>
				</div>
				<div class="card-body" id="tasks_doing">
					{% for doing in doing_list %}
						<div class="card card-light card-outline collapsed-card">
							<div class="card-header">
								<h5 class="card-title"> {{ doing.activity.title }}
								</h5>
								<div class="card-tools">
									<a href="#" class="btn btn-tool btn-link">{{ doing.endDate ? doing.endDate|date('M d') : '' }}</a>
									<button type="button" class="btn  btn-sm" data-card-widget="collapse">
										<i class="fas fa-plus"></i>
									</button>
								</div>
							</div>
							<div class="card-body">
								<p> {{ doing.assignmentDescription|raw }}
								</p>
							</div>
							<div class="card-footer">
								<div class="btn-group d-flex">
									<button class="btn btn-primary">
										Files
									</button>

									<button class="btn btn-warning">
										Progress
									</button>

									<button class="btn btn-danger">
										Members
									</button>
								</div>
							</div>
						</div>
					{% endfor %}
				</div>
			</div>
			<div class="card card-success col-sm-3 px-0">
				<div class="card-header">
					<h3 class="card-title">
						Done
					</h3>
				</div>
				<div class="card-body" id="tasks_done">
					{% for done in done_list %}
						<div class="card card-light card-outline collapsed-card">
							<div class="card-header">
								<h5 class="card-title"> {{ done.activity.title }}
								</h5>
								<div class="card-tools">
									<a href="#" class="btn btn-tool btn-link">{{ done.endDate ? done.endDate|date('M d') : '' }}</a>
									<button type="button" class="btn  btn-sm" data-card-widget="collapse">
										<i class="fas fa-plus"></i>
									</button>
								</div>
							</div>
							<div class="card-body">
								<p> {{ done.assignmentDescription|raw }}
								</p>
							</div>
							<div class="card-footer">
								<div class="btn-group d-flex">
									<button class="btn btn-primary">
										Files
									</button>

									<button class="btn btn-warning">
										Progress
									</button>

									<button class="btn btn-danger">
										Members
									</button>
								</div>
							</div>
						</div>
					{% endfor %}
				</div>
			</div>
		</div>
	</div>
{% endblock %}
{% block javascripts %}
<script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.11.4/jquery-ui.min.js" type="text/javascript"></script>
	<script>
		$('.drag').draggable({appendTo: 'body', helper: 'clone'});
		$('#tasks_doing').droppable({
			activeClass: 'active',
			hoverClass: 'hover',
			accept: ":not(.ui-sortable-helper)", // Reject clones generated by sortable
			drop: function (e, ui) {
				var $el = $('<div class="drop-item"><details><summary>' + ui.draggable.text() + '</summary><div><label>More Data</label><input type="text" /></div></details></div>');
				$el.append($('<button type="button" class="btn btn-default btn-xs remove"><span class="glyphicon glyphicon-trash"></span></button>').click(function () { $(this).parent().detach(); }));
				$(this).append($el);
			}
			}).sortable({
			items: '.drop-item',
			sort: function() {
				// gets added unintentionally by droppable interacting with sortable
				// using connectWithSortable fixes this, but doesn't allow you to customize active/hoverClass options
				$( this ).removeClass( "active" );
			}
			});
	</script>
{% endblock %}
